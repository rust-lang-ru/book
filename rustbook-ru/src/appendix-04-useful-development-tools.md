## Дополнение Г - Средства разработки

В этом дополнении мы расскажем про часто используемые средства разработки, предоставляемые Ржавчина. Мы рассмотрим принудительную разметку, быстрый путь исправления предупреждений, линтер, и встраивание с IDE.

### Принудительное изменение с `rustfmt`

Средство `rustfmt` размечает вашу рукопись в соответствии со правилами исполнения рукописи, принятым сообществом Ржавчины. Многие совместные дела используют `rustfmt`, чтобы предотвратить споры о том, какое исполнение использовать при написании Ржавчины: все размечают свою рукопись с помощью этого средства.

Для установки `rustfmt`, введите следующее:

```console
$ rustup component add rustfmt
```

Этот приказ установит `rustfmt` и `cargo-fmt`, также как Ржавчина даёт Вам одновременно `rustc` и `cargo`. Для разметки дела, использующего Cargo, введите следующее:

```console
$ cargo fmt
```

Этот приказ разметит всю рукопись на языке Ржавчина в текущем ящике. Будет изменено только исполнение рукописи, смысл останется прежним. Для больших сведений о `rustfmt`, смотрите [пособие].

### Исправление рукописи с `rustfix`

Средство rustfix включён в установку Ржавчина и может самостоятельно исправлять предупреждения сборщика с очевидным способом исправления сбоев, скорее всего, подходящим вам. Вероятно, вы уже видели предупреждения сборщика. Например, рассмотрим эту рукопись:

<span class="filename">Файл: src/main.rs</span>

```rust
fn do_something() {}

fn main() {
    for i in 0..100 {
        do_something();
    }
}
```

Мы вызываем функцию `do_something` 100 раз, но никогда не используем переменную `i` в теле круговорота `for`. Ржавчина предупреждает нас об этом:

```console
$ cargo build
   Compiling myprogram v0.1.0 (file:///projects/myprogram)
warning: unused variable: `i`
 --> src/main.rs:4:9
  |
4 |     for i in 0..100 {
  |         ^ help: consider using `_i` instead
  |
  = note: #[warn(unused_variables)] on by default

    Finished dev [unoptimized + debuginfo] target(s) in 0.50s
```

Предупреждение предлагает нам использовать `_i` как имя переменной: нижнее подчёркивание в начале определителя предполагает, что мы его не используем. Мы можем самостоятельно применить это предположение с помощью `rustfix`, запустив приказ `cargo fix`:

```console
$ cargo fix
    Checking myprogram v0.1.0 (file:///projects/myprogram)
      Fixing src/main.rs (1 fix)
    Finished dev [unoptimized + debuginfo] target(s) in 0.59s
```

Когда посмотрим в *src/main.rs* снова, мы увидим что `cargo fix` изменил нашу рукопись:

<span class="filename">Файл: src/main.rs</span>

```rust
fn do_something() {}

fn main() {
    for _i in 0..100 {
        do_something();
    }
}
```

Переменная круговорота `for` теперь носит имя `_i`, и предупреждение больше не появляется.

Также Вы можете использовать приказ `cargo fix` для перемещения вашей рукописи между различными изданиями Ржвчины. Издания будут рассмотрены в дополнении Д.

### Больше проверок с Clippy

Средство Clippy является собранием проверок (lints) для оценки вашей рукописи, поэтому Вы можете найти простые ошибки и улучшить ваш Ржавчина рукопись.

Для установки Clippy, введите следующее:

```console
$ rustup component add clippy
```

Для запуска проверок Clippy’s для дела Cargo, введите следующее:

```console
$ cargo clippy
```

Например, скажем что Вы хотите написать программу, в которой будет использоваться приближенная математическая постоянное значение, такая как число Пи, как в следующей программе:

<span class="filename">Файл: src/main.rs</span>

```rust
fn main() {
    let x = 3.1415;
    let r = 8.0;
    println!("the area of the circle is {}", x * r * r);
}
```

Запуск `cargo clippy` для этого дела вызовет следующую ошибку:

```text
error: approximate value of `f{32, 64}::consts::PI` found
 --> src/main.rs:2:13
  |
2 |     let x = 3.1415;
  |             ^^^^^^
  |
  = note: `#[deny(clippy::approx_constant)]` on by default
  = help: consider using the constant directly
  = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#approx_constant
```

Эта ошибка сообщает вам, что в Ржавчине уже определена более точная постоянное значение `PI`, и что ваша программа будет более правильной, если вы вместо неё будете использовать эту постоянное значение. Затем вы должны изменить свою рукопись, чтобы использовать постоянное значение `PI`. Следующая рукопись не приводит к ошибкам или предупреждениям от Clippy:

<span class="filename">Файл: src/main.rs</span>

```rust
fn main() {
    let x = std::f64::consts::PI;
    let r = 8.0;
    println!("the area of the circle is {}", x * r * r);
}
```

Для больших сведений о Clippy смотрите [пособие](https://github.com/rust-lang/rustfmt).

### Встраивание с IDE с помощью `rust-analyzer`

Чтобы облегчить встраивание с IDE, сообщество Ржавчина советует использовать [`rust-analyzer`]<!-- ignore -->. Это средство представляет собой набор направленных на сборщик утилит, которые используют [Language Server Protocol]<!-- ignore -->, который является сводом требований для взаимодействия IDE и языков программирования друг с другом. Разные конечные потребители могут использовать `rust-analyzer`, например [подключаемый раздел оценщика Ржавчина для Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=rust-lang.rust-analyzer).

Посетите <a>домашнюю страницу</a> дела <code>rust-analyzer</code> для получения указаний по установке, затем установите поддержку языкового отдельного вычислителя в  среде IDE. Ваша IDE получит такие возможности, как самозаполнение, переход к определению и встроенные ошибки.


[пособие]: https://github.com/rust-lang/rustfmt
[Language Server Protocol]: http://langserver.org/
[`rust-analyzer`]: https://rust-analyzer.github.io