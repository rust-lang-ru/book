## Чтение файла

Теперь добавим возможность чтения файла, указанного как переменная приказной строки `file_path`. Во-первых, нам нужен пример файла для проверки: мы будем использовать файл с небольшим размером писания в несколько строк с несколькими повторяющимися словами. В приложении 12-3 представлено стихотворение Эмили Дикинсон, которое будет хорошо работать! Создайте файл с именем *poem.txt* в корне вашего дела и введите стихотворение "I’m nobody! Who are you?"

<span class="filename">Файл: poem.txt</span>

```text
{{#include ../listings/ch12-an-io-project/listing-12-03/poem.txt}}
```

<span class="caption">Приложение 12-3: Стихотворение Эмили Дикинсон - хороший пример для проверки</span>

Текст на месте, изменените *src/main.rs* и добавьте рукопись для чтения файла, как показано в приложении 12-4.

<span class="filename">Файл: src/main.rs</span>

```rust,should_panic,noplayground
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/src/main.rs:here}}
```

<span class="caption">Приложение 12-4: Чтение содержимого файла указанного во втором переменной</span>

Во-первых, мы добавляем ещё одно указание `use` чтобы подключить соответствующую часть встроенной библиотеки: нам нужен `std::fs` для обработки файлов.

В `main` мы добавили новую указанию: функция `fs::read_to_string` принимает `file_path`, открывает этот файл и возвращает содержимое файла как `std::io::Result<String>`.

После этого, мы снова добавили временную указанию `println!` для вывода значения `contents` после чтения файла, таким образом мы можем проверить, что программа отрабатывает до этого места.

Давайте запустим эту рукопись с любой строкой в качестве первой переменной приказной строки (потому что мы ещё не выполнили поисковую часть) и файл *poem.txt* как вторую переменную:

```console
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/output.txt}}
```

Отлично! Эта рукопись прочитана и затем вывела содержимое файла. Но у программы есть несколько недостатков. Прежде всего, функция `main` решает слишком много задач: как правило функция понятнее и проще в обслуживании если она воплощает только одну мысль. Другая неполадка заключается в том, что мы не обрабатываем ошибки так хорошо, как могли бы. Пока наша программа небольшая, то эти недостатки не являются большой неполадкой, но по мере роста программы эти недостатки будет всё труднее исправлять. Хорошим решением является начинать переработку рукописи на раннем этапе разработки программы, потому что гораздо проще перерабатывать рукописи меньших размеров . Мы сделаем это далее.
